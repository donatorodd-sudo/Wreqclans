<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>W-REQ CLANS | OFFICIAL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .pasa-row { border-left: 6px solid #c5a059 !important; background: linear-gradient(90deg, rgba(197, 160, 89, 0.15), transparent) !important; }
        .pasa-tag { background: #c5a059; color: #000; font-size: 10px; font-weight: 900; padding: 2px 8px; border-radius: 3px; margin-left: 10px; box-shadow: 0 0 10px rgba(197, 160, 89, 0.5); }
        .member-grid { display: none; }
        .active .member-grid { display: grid; }
    </style>
</head>
<body class="bg-[#050505] text-white font-sans">
    <nav class="p-6 border-b border-white/5 flex justify-between items-center bg-black/80 sticky top-0 z-50 backdrop-blur">
        <h1 class="text-2xl font-black italic tracking-tighter uppercase">W-<span class="text-blue-600">REQ</span> CLANS</h1>
        <div id="status" class="text-[10px] font-bold text-yellow-500 uppercase tracking-widest">SÄ°STEM KONTROL EDÄ°LÄ°YOR...</div>
    </nav>

    <div id="clan-container" class="max-w-4xl mx-auto p-4 md:p-8 space-y-4">
        <div class="text-center py-20 opacity-20 text-xs tracking-[10px] animate-pulse">VERÄ°LER YÃœKLENÄ°YOR...</div>
    </div>

    <script>
        // --- BURAYI GÃœNCELLE ---
        const API_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTUxNjIzOTAyMn0.KMUFsIDTnFmyG3nMiGM6H9FNFUROf3wh7SmqJp-QV30"; 
        const CLAN_TAGS = ["#2QRGLRGG9", "#2PUJVQ898", "#YJJ8YLUJ"]; 
        // ------------------------

        async function fetchClans() {
            const container = document.getElementById('clan-container');
            const status = document.getElementById('status');
            let html = "";

            for (let tag of CLAN_TAGS) {
                try {
                    const proxy = "https://api.allorigins.win/get?url=";
                    const target = `https://api.clashofclans.com/v1/clans/${encodeURIComponent(tag)}`;
                    const res = await fetch(proxy + encodeURIComponent(target));
                    const json = await res.json();
                    const data = JSON.parse(json.contents);

                    if (data && data.memberList) {
                        const isMyClan = data.tag === "#2QRGLRGG9";
                        const totalDon = data.memberList.reduce((s, m) => s + m.donations, 0);

                        html += `
                            <div class="bg-[#0a0a0a] border border-white/5 rounded-xl overflow-hidden ${isMyClan ? 'pasa-row' : ''} transition-all">
                                <div class="p-5 flex justify-between items-center cursor-pointer" onclick="this.parentElement.classList.toggle('active')">
                                    <div class="flex items-center gap-4">
                                        <img src="${data.badgeUrls.small}" class="w-14 h-14">
                                        <div>
                                            <div class="flex items-center gap-2">
                                                <h2 class="font-bold text-lg uppercase italic">${data.name}</h2>
                                                ${isMyClan ? '<span class="pasa-tag">PAÅA</span>' : ''}
                                            </div>
                                            <p class="text-[10px] text-gray-500 font-bold">${data.tag} â€¢ LVL ${data.clanLevel}</p>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-[9px] text-gray-600 font-black uppercase tracking-widest">BaÄŸÄ±ÅŸ</p>
                                        <p class="text-blue-500 font-black text-2xl italic">${totalDon.toLocaleString()}</p>
                                    </div>
                                </div>
                                <div class="member-grid bg-white/[0.02] border-t border-white/5 p-2 grid grid-cols-1 md:grid-cols-2 gap-px">
                                    ${data.memberList.sort((a,b) => b.donations - a.donations).slice(0, 20).map(m => `
                                        <div class="bg-black/40 p-3 flex justify-between items-center border border-white/[0.03]">
                                            <div class="flex items-center gap-2">
                                                <span class="text-[10px] text-blue-500 font-bold bg-blue-500/10 px-1 rounded">${m.expLevel}</span>
                                                <span class="text-xs font-bold">${m.role === 'leader' ? 'ğŸ‘‘' : (m.role === 'coLeader' ? 'â­' : 'ğŸ‘¤')} ${m.name}</span>
                                            </div>
                                            <span class="text-xs font-black text-blue-400">${m.donations.toLocaleString()}</span>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>`;
                    }
                } catch (e) { console.error(e); }
            }

            if (html) {
                container.innerHTML = html;
                status.innerText = "VERÄ°LER GÃœNCEL";
                status.className = "text-[10px] font-bold text-green-500 uppercase tracking-widest";
            } else {
                container.innerHTML = `
                    <div class="bg-red-500/10 border border-red-500/50 p-6 rounded-lg text-center">
                        <p class="text-red-500 font-bold">VERÄ° ALINAMADI!</p>
                        <p class="text-xs mt-2 text-gray-400">Sebebi ÅŸunlar olabilir:<br>1. Token hatalÄ±.<br>2. Supercell IP ayarÄ± 0.0.0.0 deÄŸil.<br>3. Ä°nternet baÄŸlantÄ±sÄ± kesik.</p>
                    </div>`;
            }
        }
        fetchClans();
    </script>
</body>
</html>
